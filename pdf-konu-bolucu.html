<!doctype html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AI PDF Konu Bölücü</title>
    <style>
      :root {
        color-scheme: light dark;
        --bg: #eef3ff;
        --surface: #fff;
        --text: #172038;
        --muted: #5e6880;
        --accent: #3a63ff;
        --border: rgba(23, 32, 56, 0.14);
      }
      [data-theme="dark"] {
        --bg: #080d19;
        --surface: #121a2c;
        --text: #edf2ff;
        --muted: #a2afd2;
        --accent: #95adff;
        --border: rgba(169, 185, 232, 0.25);
      }
      * { box-sizing: border-box; }
      body {
        margin: 0; font-family: Inter, "Segoe UI", sans-serif; background: var(--bg); color: var(--text);
      }
      .wrap { width: min(980px, 92vw); margin: 36px auto 56px; display: grid; gap: 18px; }
      .card { background: var(--surface); border: 1px solid var(--border); border-radius: 18px; padding: 20px; }
      h1, h2 { margin: 0 0 10px; }
      p { margin: 0; color: var(--muted); line-height: 1.6; }
      .row { display: grid; gap: 12px; }
      textarea, input {
        width: 100%; border: 1px solid var(--border); border-radius: 12px; background: transparent;
        color: var(--text); padding: 10px 12px; font: inherit;
      }
      textarea { min-height: 110px; resize: vertical; }
      .actions { display: flex; flex-wrap: wrap; gap: 10px; }
      button, .link {
        border: 1px solid var(--border); border-radius: 999px; padding: 10px 16px; cursor: pointer;
        background: transparent; color: var(--text); text-decoration: none;
      }
      .primary { background: var(--accent); color: #fff; border-color: var(--accent); }
      .results { list-style: none; padding: 0; margin: 0; display: grid; gap: 10px; }
      .results li { border: 1px solid var(--border); border-radius: 12px; padding: 12px; }
      .file { color: var(--accent); font-weight: 600; }
      .meta { font-size: 0.9rem; color: var(--muted); }
    </style>
  </head>
  <body>
    <main class="wrap">
      <section class="card">
        <div class="actions" style="justify-content:space-between;align-items:center;">
          <a class="link" href="index.html">← Vitrine dön</a>
          <button id="themeToggle" type="button">Koyu temaya geç</button>
        </div>
        <h1>Yapay Zekâ Destekli PDF Konu Bölücü</h1>
        <p>
          PDF içeriğini konu başlıklarına göre ayırıp her bölüm için otomatik bir kesit planı üretir.
          Bu demoda yapay zekâ mantığı simüle edilmiştir; gerçek model entegrasyonu için backend API eklenebilir.
        </p>
      </section>

      <section class="card row">
        <h2>1) İçeriği yükle</h2>
        <input type="file" id="pdfFile" accept="application/pdf" />
        <textarea id="topicHint" placeholder="İsteğe bağlı: Konu başlıklarını satır satır gir (örn. Giriş, Literatür, Yöntem)"></textarea>
        <textarea id="sampleText" placeholder="Demo için PDF metninden bir örnek parça yapıştırabilirsin.">1. Giriş\nBu rapor yapay zekâ destekli sistemleri anlatır.\n2. Literatür Taraması\nBenzer çalışmalar incelenmiştir.\n3. Yöntem\nKural tabanlı segmentasyon ve başlık tespiti kullanılmıştır.\n4. Sonuç\nSistem bölümlere ayırmayı başarıyla tamamlamıştır.</textarea>
        <div class="actions">
          <button class="primary" id="analyzeBtn" type="button">Konu başlıklarını analiz et</button>
        </div>
      </section>

      <section class="card row">
        <h2>2) Bölme planı</h2>
        <ul class="results" id="results"></ul>
      </section>
    </main>

    <script>
      const resultEl = document.getElementById("results");
      const analyzeBtn = document.getElementById("analyzeBtn");
      const topicHint = document.getElementById("topicHint");
      const sampleText = document.getElementById("sampleText");
      const pdfFile = document.getElementById("pdfFile");
      const themeToggle = document.getElementById("themeToggle");

      const extractHeadings = (text) => {
        const explicit = topicHint.value
          .split("\n")
          .map((v) => v.trim())
          .filter(Boolean);

        if (explicit.length) {
          return explicit;
        }

        const lines = text.split("\n").map((line) => line.trim()).filter(Boolean);
        const detected = lines.filter((line) => /^(\d+\.|[A-ZÇĞİÖŞÜ][\wçğıöşü\s]{2,})/.test(line));
        return [...new Set(detected)].slice(0, 8);
      };

      const createPlan = (topics) => {
        if (!topics.length) {
          return [
            {
              title: "Başlık bulunamadı",
              file: "bolum-1.pdf",
              range: "Sayfa aralığı tespit edilemedi",
            },
          ];
        }

        return topics.map((topic, index) => ({
          title: topic,
          file: `${String(index + 1).padStart(2, "0")}-${topic.toLowerCase().replace(/\s+/g, "-").replace(/[^a-z0-9-çğıöşü]/gi, "")}.pdf`,
          range: `${index * 3 + 1}-${index * 3 + 3}. sayfalar (öneri)`,
        }));
      };

      const renderPlan = (plan) => {
        resultEl.innerHTML = "";
        plan.forEach((item) => {
          const li = document.createElement("li");
          li.innerHTML = `
            <strong>${item.title}</strong>
            <div class="file">${item.file}</div>
            <div class="meta">${item.range}</div>
          `;
          resultEl.append(li);
        });
      };

      analyzeBtn.addEventListener("click", () => {
        const fileName = pdfFile.files[0]?.name;
        const topics = extractHeadings(sampleText.value);
        const plan = createPlan(topics);
        renderPlan(plan);

        if (fileName) {
          const note = document.createElement("li");
          note.innerHTML = `<div class="meta">Kaynak dosya: <strong>${fileName}</strong></div>`;
          resultEl.prepend(note);
        }
      });

      const setTheme = (theme) => {
        document.documentElement.setAttribute("data-theme", theme);
        themeToggle.textContent = theme === "dark" ? "Açık temaya geç" : "Koyu temaya geç";
      };
      const savedTheme = localStorage.getItem("pdf-theme");
      setTheme(savedTheme || "light");
      themeToggle.addEventListener("click", () => {
        const current = document.documentElement.getAttribute("data-theme");
        const next = current === "dark" ? "light" : "dark";
        setTheme(next);
        localStorage.setItem("pdf-theme", next);
      });

      renderPlan(createPlan(extractHeadings(sampleText.value)));
    </script>
  </body>
</html>
